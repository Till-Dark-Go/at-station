rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // 1. Public Stations (read-only)
    match /stations/{stationId} {
      allow read: if true;          // app can only read
      allow write: if false; // only admin script can write
    }

    // 2. User data (private per user)
    match /users/{userId} {
      allow read, write: if request.auth != null 
                         && request.auth.uid == userId; 
    }

    // 3. Sessions (user-owned)
    match /sessions/{sessionId} {
      allow read, write: if request.auth != null
                         && request.resource.data.userId == request.auth.uid;
    }
  }
}
